<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" []>
<chapter>
  <title>IROAD 2 Spreadsheet Reporting</title>
  <para>The information  in the system is available in many different formats, such as:  .xls, .doc, .pdf, .csv., etc. which are familiar to different end-users. In this sense, a sustainable information system with an extended support for .xls (tables, sheets, and expressions) is a prerequisite while in the developing countries like Vietnam, India, Sri Lanka, etc use spreadsheet application (from Microsoft Office and Open Office) for their routine documents and reports. At the same time, this also supports efficiently for implementation processes by reducing time and effort for training and maintenance because of its friendliness and powerfulness of availability and flexibility.</para>
  <para>The end-users, especially health workers with an average knowledge of computing, can use IROAD 2 easily with the new spreadsheet reporting tool (or probably called  as Spreadsheet reporting) developed by the Vietnam developer  team.  This module has been  based on HISP India teamâ€™s ideas and technologies.  The module has subsequently been merged into the main IROAD2 application under the Vietnam (vn) local branch for available usage. There will be a session for instructing &quot;how to include the Spreadsheet reporting module into IROAD2&quot;.  This reporting tool with spreadsheet output files uses less memory and it is comparatively faster when compared to other reporting platforms. The spreadsheet reporting module provides a flexible reporting framework, which should be immediately intuitively useful for many users who are familiar with this.  </para>
  <screenshot>
    <mediaobject>
      <imageobject>
        <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/administration_page.png" format="PNG"/>
      </imageobject>
    </mediaobject>
  </screenshot>
  <para><emphasis role="italic">Figure 1: Administration sections</emphasis></para>
  <section>
    <title>Include &apos;Spreadsheet reports&apos; module into IROAD2</title>
    <para>The following is the steps of building/developing an IROAD2 package with spreadsheet report module.</para>
    <para><emphasis role="bold">Step 1: Download IROAD2 source-code and some other necessary tools</emphasis></para>
    <para>See the instructions from here: <ulink url="http://dhis2.org/development#quickstart">http://dhis2.org/development#quickstart</ulink></para>
    <para>esp. the first 3 points.</para>
    <para><emphasis role="bold">Step 2: Build the source-code at first without the Spreadsheet module</emphasis></para>
    <para>See the instructions from here: <ulink url="http://dhis2.org/development#quickstart">http://dhis2.org/development#quickstart</ulink></para>
    <para>esp. the fourth point with 2 build commands with maven.</para>
    <para><emphasis role="bold">Step 3: Build the Spreadsheet module and then rebuild the IROAD2 package including it</emphasis></para>
    <para>Go to the spreadsheet module and execute the building commands: <emphasis role="italic">mvn clean install -Dmaven.test.skip=true</emphasis></para>
    <para>Normally, the spreadsheet module is  located at: &lt;dhis2_source_folder&gt;\dhis2\local\vn:</para>
    <para>3.1: Run the mvn command under &quot;dhis-service-excel-reporting&quot; folder.</para>
    <para><emphasis role="underline">for example: </emphasis></para>
    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/spreadsheet-maven.png" format="PNG"/>
        </imageobject>
      </mediaobject>
    </screenshot>
    <para>3.1: Run the mvn command under &quot;dhis-web-excel-reporting&quot; folder. </para>
    <para>3.2: Edit the pom.xml file under &quot;dhis-web-portal&quot; (at: &lt;dhis2_source_folder&gt;\dhis2\dhis-2\dhis-web\dhis-web-portal) to include the Spreadsheet module</para>
    <para>for example:</para>
    <para><screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/spreadsheet-pom.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot></para>
    <para>3.3: Build the web-portal module: </para>
    <para>(at: &lt;dhis2_source_folder&gt;\dhis2\dhis-2\dhis-web\dhis-web-portal)</para>
    <para>for example:</para>
    <para><screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/spreadsheet-maven-1.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot></para>
    <para>After successfully build the package, the dhis.war in the target folder of dhis-web-portal module will be produced.</para>
    <para>Copy this war file to the webapps folder of your tomcat folder.</para>
    <para>In order to make a fresh update for your new dhis2, before starting tomcat, delete the old dhis.war file and &quot;dhis&quot; folder under webapps.</para>
    <para><emphasis role="bold">Step 4: Run the IROAD2 built package with Spreadsheet module</emphasis></para>
    <para>Run tomcat (execute the bath file under &lt;tomcat_folder&gt;\bin\startup.bat (for Windows) or ...\startup.sh (for Linux).</para>
    <para>Then wait until the start-up finishes and open a web browser (Firefox recommended) to run the IROAD2 application with the local url or your IP address:</para>
    <para><ulink url="http://localhost:8080/dhis">http://localhost:8080/dhis</ulink></para>
    <para>So good-luck to you for further exploration/hacking with dhis2.</para>
    <para>For further support, please send an email to the developer mailing list: </para>
    <para>&quot;IROAD 2 developers&quot; &lt;<ulink url="dhis2-devs@lists.launchpad.net">dhis2-devs@lists.launchpad.net</ulink>&gt;</para>
    <para/>
  </section>
  <section>
    <title>Administration</title>
    <para>There are 6 sections for the &quot;Administration&quot; of this reporting tool.</para>
    <orderedlist>
      <listitem>
        <para><emphasis role="italic">Configuration</emphasis>: Set a path to the directory where the spreadsheet template files are stored. This file path should be a relative directory on your system. For instance, if the home directory of IROAD 2  (by setting the absolute path with the IROAD2_HOME environmental variable) is &quot;C:\dhis2&quot; and you want to name the template folder &quot;templates&quot;, just set: &quot;templates&quot; for Windows or &quot;templates&quot; for Linux, then the absolute path of your template folder will be: &quot;C:\dhis2\spreadsheet_template\templates&quot; (Windows).</para>
        <para><screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/configuration_0.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot></para>
        <para><emphasis role="italic">Figure 2: Configuration setting</emphasis></para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Export reports</emphasis>: This module allows users to assign reports to different organizational units . There are four types of reports that are currently supported: a report containing standard data elements,  a report listing organisation unit groups as rows, a report listing period of time as columns, a report generating data elements combined with categories.</para>
        <para><screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/report_associations.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot></para>
        <para><emphasis role="italic">Figure 3: Export report list</emphasis></para>
        <para>Report associations are used to determine which organizational units the report should be associated with. Click the &quot;Report Associations&quot; button, and assign all the organizational units which this report applies to by either clicking on the organizational units listed in the hierarchy tree, or by selecting the appropriate organizational unit group through the drop down menu. </para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Data Entry Status</emphasis> (or view the status of the data entry): View the data entry status to know about data  entered, reports finished or not finished yet with data entry. In order to view the data entry status, adding data sets which is equivalent to the data entry is mandatory.</para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Import Reports items</emphasis>: In many situations, health workers in the field may not have good Internet access, and will therefore need to enter data offline and to transmit this data via email or other means, for subsequent importation into the IROAD database.  The spreadsheet Report data import feature allows users to import data from a pre-designed spreadsheet templates directly into the IROAD database automatically. Users enter data into a predefined spreadsheet template, send via email or other means for importation into IROAD2. It is also possible to import selected elements. This module supports three types of reports namely a report containing standard data elements,  a report listing organisation unit groups as rows, a report generating data elements combined with categories.</para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Excel /Spreadsheet Template Management</emphasis>: Manage the Template spreadsheet files which are used to export reports, includes upload, download, delete and rename files.</para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Clean temporary directory</emphasis>: Every time a user generates a report, the system creates an spreadsheet file in the temporary directory (<envar>spreadsheetreporttemplate</envar> directory). This disk space occupied by this directory will become progressively larger after some time. This function will remove all the temporary files from the directory, and therefore decrease the total amount of disk space used.</para>
      </listitem>
    </orderedlist>
    <section id="excelReportingConfiguration">
      <title>Configuration</title>
      <para>The directory configuration is to set the path of the directory containing the spreadsheet Template (.xls) file. </para>
      <para>In order to set the directory, choose  <emphasis role="bold">Administrator &gt; Configuration&gt;</emphasis> Set path and specify the path. The procedure is outlined in more detail below. </para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Administration</emphasis> to open Administrator page.</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/configuration.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 4: Configuration menu</emphasis></para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Configuration</emphasis> button</para>
        </listitem>
        <listitem>
          <para>Set a relative path to the folder containing spreadsheet file </para>
          <para>An spreadsheet template directory is simply a directory that will be used to contain all the necessary files. It is automatically created the folder under <envar>IROAD2_HOME</envar> folder. </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/configuration_1.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 5: Configure the directory relative path for spreadsheet templates</emphasis></para>
          <para>Click <emphasis role="bold">OK</emphasis> to save</para>
        </listitem>
      </orderedlist>
    </section>
    <section id="excelReportingListOfReports">
      <title>Export Reports </title>
      <para>The function allows users to create reports and its items and to assign the organisation units or the organisation unit groups to the reports. Each of the functions of this module will be described below. </para>
      <section>
        <title>Types of report</title>
        <para>Before generating reports, there is a need to create  spreadsheet report template files.  Reports will be generated in a standard format according to the structure defined in the template. Currently, there are four report types that the module can support.</para>
        <orderedlist>
          <listitem>
            <para><emphasis role="bold">Standard reports contain default data elements and indicators</emphasis></para>
            <para>Standard reports have a fixed model in which number of the columns and the rows are unchangeable. Normally, this report is generated by only one organisation unit or one  organisation unit group at a specified period of time. An example is show below.</para>
            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/standard_report_template.png" format="PNG"/>
                </imageobject>
              </mediaobject>
            </screenshot>
            <para><emphasis role="italic">Figure 6: A spreadsheet template with standard reports</emphasis></para>
          </listitem>
          <listitem>
            <para><emphasis role="bold">Row-based reports with multiple organisational</emphasis></para>
            <para>This type of report displays data elementsâ€™ name in the fixed columns, and organisation units are be displayed automatically according to the selected parents organisation unit in a period of time. These organisation units are also grouped together following the administrative level, such as: province, district, commune, etc.</para>
            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/list_org_unit_group_report_template.png" format="PNG"/>
                </imageobject>
              </mediaobject>
            </screenshot>
            <para><emphasis role="italic">Figure 7: A spreadsheet template with row-based reports</emphasis></para>
          </listitem>
          <listitem>
            <para><emphasis role="bold">Reports list time periods in the columns</emphasis></para>
            <para>This report display data values according to the fixed data element names, and the list of time periods are displayed automatically.</para>
            <para><screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/list_time_period_report_template.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot></para>
            <para><emphasis role="italic">Figure 8: A spreadsheet template with period-listing reports</emphasis></para>
          </listitem>
          <listitem>
            <para><emphasis role="bold">Reports with data elements and categories</emphasis></para>
            <para>This type of report displays data values which are combined of data elements and category combination. Data element names display as rows and category options are displayed as columns. Data elementsâ€™ names, codes may be displayed automatically as well as the sequence numbers of the rows</para>
            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/dataelement_category_report_template.png" format="PNG"/>
                </imageobject>
              </mediaobject>
            </screenshot>
            <para><emphasis role="italic">Figure 9: A spreadsheet template with data-element and categories reports</emphasis></para>
          </listitem>
        </orderedlist>
      </section>
      <section>
        <title>Create a new report in IROAD2 with spreadsheet report template file</title>
        <para>When the spreadsheet report template file is available, creating a new report and the relevant report items are required. A step-by-step procedure is provided below.</para>
        <orderedlist>
          <listitem>
            <para>To create a new report, choose  <emphasis role="bold">Administration</emphasis> --&gt; <emphasis role="bold">Export Reports</emphasis> --&gt; <emphasis role="bold">Add</emphasis> --&gt; Fill the information form --&gt; <emphasis role="bold">OK</emphasis></para>
          </listitem>
          <listitem>
            <para>To create report items in the report  choose <emphasis role="bold">Administration</emphasis> --&gt; <emphasis role="bold">Export Reports</emphasis> --&gt; Choose a report --&gt; <emphasis role="bold">Report Items</emphasis> --&gt; <emphasis role="bold">Add</emphasis> --&gt; Fill information form --&gt; <emphasis role="bold">OK</emphasis></para>
          </listitem>
        </orderedlist>
        <section>
          <title>Create new report </title>
          <para>Click <emphasis role="bold">Export Reports</emphasis> </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/list_of_reports.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 10: Administration - Export Reports menu</emphasis></para>
          <para>Add new report: Click Add button to add new report</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/list_of_reports_1.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 11: The list of export reports</emphasis></para>
          <para>Each of the fields should be filled in. </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_new_report.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <itemizedlist>
            <listitem>
              <para><emphasis role="italic">Name</emphasis> *: Enter a descriptive name of the report. </para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">spreadsheet Template</emphasis>*:  Choose a spreadsheet report template file from the list.</para>
            </listitem>
            <listitem>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_new_report_1.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot>
              <para><emphasis role="italic">Figure 12: Choose a template for an export report</emphasis></para>
              <para>The template files can be updated by uploading the spreadsheet files under &quot;spreadsheet Template Management&quot; session.</para>
              <para><emphasis role="bold">Report Type *: Choose report type </emphasis></para>
              <itemizedlist>
                <listitem>
                  <para>Normal : to create reports include just data elements or indicators</para>
                </listitem>
                <listitem>
                  <para>Category : to create reports with data values are combined of data elements and categories </para>
                </listitem>
                <listitem>
                  <para>Period column listing: to create reports which list data values according to time period of specified organisation unit.</para>
                </listitem>
                <listitem>
                  <para>Organisation unit listing: reports which list data values according to organisation units.</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para>Period position row and Period position column: Row and Column Number in spreadsheet template file where to put Period value.</para>
            </listitem>
            <listitem>
              <para>Organisation Unit Row and Organisation Unit Column: Row and Column Number in spreadsheet template file where to put Organisation Unit Name.</para>
            </listitem>
            <listitem>
              <para>Click <emphasis role="bold">OK</emphasis> button to create new report</para>
            </listitem>
          </itemizedlist>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/list_of_reports_3.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 13: Overview of functions for an export report</emphasis></para>
          <para>There are  buttons that can be used for various actions as depicted below: </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/export_report_1.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 14: Functions with detailed descriptions.</emphasis></para>
          <itemizedlist>
            <listitem>
              <para>Organisation level <inlinegraphic fileref="resources/images/dhis_excel_reports/list_of_reports_Set_orgunit_group_level.png" align="center"/>for setting organisation group level.</para>
            </listitem>
            <listitem>
              <para>Report Associations    <inlinegraphic fileref="resources/images/dhis_excel_reports/association_org_unit.GIF"/>for assigning reports to organisation units</para>
              <para>Simply select the organizational units that this report will be generated for. </para>
            </listitem>
            <listitem>
              <para>The Report Item  <inlinegraphic fileref="resources/images/dhis_excel_reports/report_item.png"/>    function is used to define which values will appear in the desired report. Report items consist of specific values of data which will be placed into particular cells of the spreadsheet when the report is generated.Further information for configuration of the report items will be provided in the next section. </para>
            </listitem>
            <listitem>
              <para> The Remove  <inlinegraphic fileref="resources/images/dhis_excel_reports/remove_report.png"/> deletes the spreadsheet report. </para>
            </listitem>
            <listitem>
              <para>Edit  <inlinegraphic fileref="resources/images/dhis_excel_reports/edit_report.png"/>for editing reportâ€™s information.</para>
            </listitem>
            <listitem>
              <para>Organisation unit Group    <inlinegraphic fileref="resources/images/dhis_excel_reports/assign_org_unit_group.png"/> for choose which organisation group would be list in the report. This button only appears when the Report Type is Organisation Unit Listing</para>
            </listitem>
            <listitem>
              <para>Data element groups <inlinegraphic fileref="resources/images/dhis_excel_reports/assign_data_element_group.png"/>  for creating Data element group and these groups of data elements would be list in the report. This button is only available when the report type is a &quot;Category&quot; report. </para>
            </listitem>
            <listitem>
              <para>Period column <inlinegraphic fileref="resources/images/dhis_excel_reports/list_of_reports_Create_period_column.png" align="center"/>for creating Period column. THis button is only available when the report type is a &quot;Reports list time periods in the columns&quot;</para>
            </listitem>
          </itemizedlist>
        </section>
        <section>
          <title>Create report items</title>
          <para>Click <emphasis role="bold">Create Report Item</emphasis> button to begin the process of defining a new report. Report items consist of different types of data that will be dynamically generated based on a user&apos;s inputs during the report generation phase. Report items must be defined and referenced to a particular spreadsheet template. </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/create_new_report_0.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 15: Export Item List menu</emphasis></para>
          <para>Click on the list of &quot;Export Item&quot; (screen-shot above) </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/report_item_function.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 16: Overview the operations toward an export-items</emphasis></para>
          <para><emphasis role="bold">Add</emphasis> button to open a form</para>
          <para>Fill the report itemâ€™s information. Each of the fields is described below in more detail. </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/create_new_report_item.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 17: Instructions for creating an item</emphasis></para>
          <itemizedlist>
            <listitem>
              <para><emphasis role="italic">Name</emphasis>: Enter a descriptive name for the report. (Ex: Total person joined HIA)</para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Item</emphasis> Type: </para>
              <orderedlist>
                <listitem>
                  <para><emphasis role="italic">Data element</emphasis> : Select this item type if the value of a particular data element  should be placed in the spreadsheet report. </para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Indicator</emphasis>: Select this item type if the value of a particular indicator should be placed in the spreadsheet report. </para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Spreadsheet formula</emphasis>: Select this item type if an spreadsheet formula should be placed in the cell. You will need to define the spreadsheet formula in the next step. </para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Serial</emphasis> : A sequential number will automatically be generated and placed in the report.</para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Organisation</emphasis>: if report item is list of organisation unit.</para>
                </listitem>
              </orderedlist>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Period Type</emphasis>*: Chose period type which data values of that report item would be aggregated and displays according to period parameter that user will choose when generate report. (Last 3 months, Last 6 months, So far this year, Quarterly, Six-Monthly, Yearly).</para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Expression</emphasis> *: Click Expression button to define a particular data element or combination of data elements in a formula, if you have selected this report item type. If this report item type is &quot;Organization&quot; or &quot;Serial&quot; this option is not relevant. If the report item type is an spreadsheet formula, it should be entered directly in the text box. For instance, a valid spreadsheet formula might be &quot;=C1R1/C2R1&quot;, which would divide the cell in position (1,1) in the spreadsheet by the cell in position (2,1)</para>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/create_expression_1.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot>
              <para><emphasis role="italic">Figure 18: Instructions for defining an expression for an item</emphasis></para>
              <para>The category option would be  <emphasis role="italic">default</emphasis> if data element hasnâ€™t been combined with any category combo. Other options are described below:</para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Sheet No</emphasis>*: Specify the  sheet number where this report item would be display in the spreadsheet template file. </para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Row</emphasis>*: Row number refers to cell where report item would be display in spreadsheet file.</para>
            </listitem>
            <listitem>
              <para><emphasis role="italic">Column</emphasis>*: Column number refers to cell where report item would be display in spreadsheet file.</para>
            </listitem>
            <listitem>
              <para>Once all items have been filled in, click the &quot;<emphasis role="bold">OK</emphasis>&quot; button to save the report definition. </para>
            </listitem>
          </itemizedlist>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/new_report_item.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 19: Confirm and Save the item&apos;s modification</emphasis></para>
          <para>You will be informed that a new report item has been created. </para>
          <para>The &quot;<emphasis role="bold">Copy to Export&quot;</emphasis>  function can be used to copy spreadsheet report items from one report to another. Therefore, there is no need to redefine an spreadsheet report item, if it will appear in two different reports. You can simply copy the item from one report definition to the other by following this procedure. <orderedlist>
              <listitem>
                <para>From list of reports page, click &quot;Add  new report.&quot;</para>
              </listitem>
              <listitem>
                <para>From the source report, select the report items that should be copied by clicking on the appropriate check boxes of the items.</para>
              </listitem>
              <listitem>
                <para>Click the <emphasis role="bold">&quot;Copy report items to Export&quot;</emphasis> button.</para>
              </listitem>
              <listitem>
                <para><emphasis role="italic">Export report</emphasis>: Chose the destination report. </para>
              </listitem>
              <listitem>
                <para><emphasis role="italic">Sheet No</emphasis>: Choose the sheet number where the report items would be displayed.</para>
              </listitem>
              <listitem>
                <para>Finally, Click the <emphasis role="bold">OK</emphasis> button to copy the report items. </para>
              </listitem>
            </orderedlist></para>
          <para><emphasis role="italic">Figure 20: Choose a report and sheet number for copying the items to</emphasis></para>
          <para><emphasis role="bold">Copy to export items to Import</emphasis>  button: To copy the report items from the export reports to an import report.</para>
          <para> </para>
          <para><orderedlist>
              <listitem>
                <para>From source report, select report items need to be copied.</para>
              </listitem>
              <listitem>
                <para>Click the <emphasis role="bold">Copy export items to Import</emphasis> button</para>
              </listitem>
              <listitem>
                <para><emphasis role="italic">Import Reports</emphasis>: chose a destination report</para>
              </listitem>
              <listitem>
                <para><emphasis role="italic">Sheet No</emphasis>: Choose the Sheet No at which the import item would be copied to (equilavent to the sheet of the expected importing spreadsheet file).</para>
              </listitem>
              <listitem>
                <para>Click <emphasis role="bold">OK</emphasis> button to copy</para>
              </listitem>
            </orderedlist></para>
          <para><emphasis role="italic">Figure 21: Choose an import report and sheet number for copying the items to</emphasis></para>
        </section>
      </section>
      <section>
        <title>Report Assignment </title>
        <section>
          <title>Assign a report to Org Units </title>
          <para>This function will determine which organizational units the report should be assigned to. Click the<emphasis role="bold">Report Associations</emphasis> button from the main page. </para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/report_associate.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 22: Report Assignment for OrganizationUnits</emphasis></para>
          <para>Chose OrgUnits to assign and click  the Save button.</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/select_orgunit.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 23: Report Assignment for OrganizationUnits</emphasis> (cont.)</para>
          <para>Select each organizational unit that the report can be generated for, or alternatively, select multiple organizational units by selecting a particular organizational unit level or group.</para>
          <para>This function only appears in <emphasis role="bold">Organization Unit Listing</emphasis> report type. </para>
          <para>Click <emphasis role="bold">Organisation Unit group</emphasis> button.</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/select_orgunit_group.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 24: OrganizationUnit Group setting for an export report</emphasis></para>
          <para>Select Organisation unit groups, arrange sequence of these groups, and click <emphasis role="bold">OK</emphasis> to save.</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/select_orgunit_group_1.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 25: In details for OrganizationUnit Group setting</emphasis></para>
        </section>
        <section>
          <title>Assign report to user role</title>
          <para>To manage the authority of using the reports, we should assign reports to user roles. This allows the administrator to decide which users are able to view certain reports.</para>
          <orderedlist>
            <listitem>
              <para>From <emphasis role="bold">Export Reports</emphasis> sub-menu (see Fig. 22), choose <emphasis role="bold">Assign user-role for the export report</emphasis></para>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/assign_user_role.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot>
              <para><emphasis role="italic">Figure 26: User Role menu</emphasis></para>
            </listitem>
            <listitem>
              <para>Then setting the  User Roles for the export report</para>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="12%" align="center" fileref="resources/images/dhis_excel_reports/edit_user_role.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot>
              <para><emphasis role="italic">Figure 27: User role</emphasis> <emphasis role="italic">setting for the report</emphasis></para>
              <para><emphasis role="underline">
                  <emphasis role="bold">How to define an user-role, see the following screenshots:</emphasis>
                </emphasis></para>
              <para>Go to User Role management:</para>
              <para>Maintenance &gt;&gt; Users &gt;&gt; User Role</para>
              <para><screenshot>
                  <mediaobject>
                    <imageobject>
                      <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/edit_user_role_1.png" format="PNG"/>
                    </imageobject>
                  </mediaobject>
                </screenshot></para>
              <para><emphasis role="italic">Figure 28: User Role menu</emphasis></para>
              <para>Then choose an user role to edit or create a new user role:</para>
              <para><screenshot>
                  <mediaobject>
                    <imageobject>
                      <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/edit_user_role_2.png" format="PNG"/>
                    </imageobject>
                  </mediaobject>
                </screenshot></para>
              <para><emphasis role="italic">Figure 29: User Role management</emphasis></para>
              <para>Setting for an user role:</para>
              <para><screenshot>
                  <mediaobject>
                    <imageobject>
                      <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/edit_user_role_3.png" format="PNG"/>
                    </imageobject>
                  </mediaobject>
                </screenshot></para>
              <para><emphasis role="italic">Figure 30: User Role settings for dataset and functions access</emphasis></para>
            </listitem>
          </orderedlist>
        </section>
      </section>
    </section>
    <section id="excelReportingDataEntryStatus">
      <title>Data Entry Status</title>
      <para>This function allows users to see which datasets are entered with data and how the data values are entered. This helps save time for the health manager to follow the completeness of the data entered. In particular, there is a need of viewing data set entry status.</para>
      <para>Add data set to view</para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/data_entry_status.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para><emphasis role="italic">Figure 31: Data-Entry Status Management menu</emphasis></para>
      <para><emphasis role="bold">Data Entry Status</emphasis> page would be displayed. Click <emphasis role="bold">Add</emphasis> button to add data set.</para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para><emphasis role="italic">Figure 32: Add a new status management</emphasis></para>
      <para>Then select the desired data set and Organisation Unit from the menu.</para>
      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status_1.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para><emphasis role="italic">Figure 33: Choose an Organization Unit for data-entry status</emphasis></para>
      <para>And set-up for the data-entry status by choosing the dataset:</para>
      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status_2.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para><emphasis role="italic">Figure 34: Choose an dataset for data-entry status</emphasis></para>
      <para>Moreover, you can choose/pick the statuses as the defaults for the organization unit:</para>
      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status_3a.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para><emphasis role="italic">Figure 35a: Set-up default for the status</emphasis></para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status_3b.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para><emphasis role="italic">Figure 35b: The list of data-entry status</emphasis></para>
      <para>An screen-shot example:</para>
      <para><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_data_entry_status_3c.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para><emphasis role="italic">Figure 35c: Data-entry status of an organization unit by its dataset</emphasis>s</para>
    </section>
    <section id="excelReportingExcelItems">
      <title>Spreadsheet/Import items</title>
      <para>The function allows users to import data from a pre-designed spreadsheet templates directly into the IROAD database automatically. Alternatively, selected elements may be imported. This is a particularly useful feature for importing data from other users that may not have IROAD2 installed on their computers. For instance, it may be more feasible to have users at a primary  care health facility enter their values in spreadsheet directly. Users may be immediately familiar with spreadsheet, and can easily enter data into a pre-defined template. Installation of IROAD2 on their computers may complicate a particular implementation, and require additional resources in terms of training. By using pre-defined templates for importation into the IROAD2 database, users that do  not have IROAD2 can easily transmit data to users that do, for instance from the primary health care facility to the district level. </para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/excelitem_groups.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para><emphasis role="italic">Figure 33: Import Report List</emphasis></para>
      <section>
        <title>Create a template to import</title>
        <para><orderedlist>
            <listitem>
              <para>To create a group, choose  <emphasis role="bold">Administration</emphasis> -&gt;<emphasis role="bold"> Import Reports</emphasis> -&gt; <emphasis role="bold">Add </emphasis>--&gt; Fill the information form and press <emphasis role="bold">OK</emphasis>.</para>
            </listitem>
            <listitem>
              <para>To create items in the grorp,  choose <emphasis role="bold">Administration</emphasis> --&gt; <emphasis role="bold">Import Reports</emphasis> --&gt; Choose a group --&gt; <emphasis role="bold">Spreadsheet/Excel items </emphasis>--&gt; Fill information form -&gt; <emphasis role="bold">OK</emphasis>.</para>
            </listitem>
          </orderedlist>Creating a spreadsheet items group which contains spreadsheet items. A spreadsheet item correspond with a data cell into inputted template spreadsheet files. A step-by-step procedure is provided below.</para>
        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_excelitem_group.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot>
        <para><emphasis role="italic">Figure 32: Create a new Import Item</emphasis></para>
        <itemizedlist>
          <listitem>
            <para><emphasis role="italic">Name </emphasis>*: Enter Name of report.</para>
          </listitem>
          <listitem>
            <para><emphasis role="italic">Report Type </emphasis>*: Choose report type<itemizedlist>
                <listitem>
                  <para><emphasis role="italic">Normal</emphasis> : to create group include just data elements or indicator</para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Category</emphasis> : to create group  with data values are combined of data elements and categories</para>
                </listitem>
                <listitem>
                  <para><emphasis role="italic">Organisation unit listing </emphasis>: groups which list data values according to organisation units.</para>
                </listitem>
              </itemizedlist></para>
          </listitem>
          <listitem>
            <para><emphasis role="italic">Period Type </emphasis>*: Type of period to import data values.</para>
          </listitem>
        </itemizedlist>
        <para>Click <emphasis role="bold">OK</emphasis> button to create new report.</para>
        <para>There are buttons that can be used for various actions as depicted below.</para>
        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/excelitem_groups_buttons.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot>
        <para><emphasis role="italic">Figure 33: Operations of import reports</emphasis></para>
        <itemizedlist>
          <listitem>
            <para> Associations    <inlinegraphic fileref="resources/images/dhis_excel_reports/association_org_unit.GIF"/>for assigning a group to organisation units.</para>
          </listitem>
          <listitem>
            <para>Spreadsheet item group <inlinegraphic fileref="resources/images/dhis_excel_reports/report_item.png"/>for creating report items in the report.</para>
          </listitem>
          <listitem>
            <para>Remove  <inlinegraphic fileref="resources/images/dhis_excel_reports/remove_report.png"/>for removing spreadsheet item group.</para>
          </listitem>
          <listitem>
            <para>Edit  <inlinegraphic fileref="resources/images/dhis_excel_reports/edit_report.png"/>for editing  information of group.</para>
          </listitem>
          <listitem>
            <para>Organisation unit Group    <inlinegraphic fileref="resources/images/dhis_excel_reports/assign_org_unit_group.png"/> for choose which organisation group would be list in the group. This button only appear when the Group Type is Organisation Unit Listing</para>
          </listitem>
          <listitem>
            <para>Data element groups <inlinegraphic fileref="resources/images/dhis_excel_reports/assign_data_element_group.png"/>  for create Data element group and these groups of data elements would be list in the report. This button only available when report type is Category. </para>
          </listitem>
        </itemizedlist>
      </section>
      <section>
        <title>Create spreadsheet items</title>
        <para>Click <emphasis role="bold">Add</emphasis> button to open a form.
          </para>
        <para><screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/add_excelitem.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot></para>
        <para><emphasis role="italic"> Figure 34: Import item description</emphasis></para>
        <para>Fill information of an spreadsheet items.<itemizedlist>
            <listitem>
              <para>Name*: Enter  item name</para>
            </listitem>
            <listitem>
              <para>Expression *: Click Expression button to choose Data element, Indicator, Or just type spreadsheet formula if Item type is spreadsheet formula.</para>
              <screenshot>
                <mediaobject>
                  <imageobject>
                    <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/create_expression_1.png" format="PNG"/>
                  </imageobject>
                </mediaobject>
              </screenshot>
              <para><emphasis role="italic">Figure 35: Expression building</emphasis></para>
              <para>The category option would be  <emphasis role="italic">default</emphasis> if data element hasnâ€™t been combined with any category combo. Other options are described below:</para>
            </listitem>
            <listitem>
              <para>Sheet No*: type sheet no where this  item would be display in spreadsheet template file</para>
            </listitem>
            <listitem>
              <para>Row*: row number refers to cell where  item would be display in spreadsheet file.</para>
            </listitem>
            <listitem>
              <para>Column*: column number refers to cell where  item would be display in spreadsheet file.</para>
            </listitem>
            <listitem>
              <para>Click <emphasis role="bold">OK</emphasis> button to create  item.</para>
            </listitem>
          </itemizedlist></para>
        <para><emphasis role="bold">Copy selected items to</emphasis> button: To copy the report items when the new report has an item which can be reused from the existing report</para>
        <para><screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/copy_report_item.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot></para>
        <para><emphasis role="italic">Figure 36: Choose import report and sheet number</emphasis></para>
        <orderedlist>
          <listitem>
            <para>From List of groups page, select  items need to be copied.</para>
          </listitem>
          <listitem>
            <para>Click the <emphasis role="bold">Copy selected items to</emphasis> button.</para>
          </listitem>
          <listitem>
            <para><emphasis role="italic">List of groups</emphasis>: chose a destination report.</para>
          </listitem>
          <listitem>
            <para><emphasis role="italic">Sheet No</emphasis>: Choose the Sheet No which report Item would be display.</para>
          </listitem>
          <listitem>
            <para>Click <emphasis role="bold">OK</emphasis> button to copy.</para>
          </listitem>
        </orderedlist>
      </section>
    </section>
    <section id="excelReportingExcelTemplateManagement">
      <title>Spreadsheet Template Management </title>
      <para>This is used to manage Template spreadsheet files which are  used to export reports, includes upload, download, delete and rename files.</para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/excel_template_management.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para><emphasis role="italic">Figure 37: Excel Template Management</emphasis></para>
      <para>To upload template file, choose <emphasis role="bold">Browse</emphasis> button.<screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/upload_template_excel_file.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para arch=""><emphasis role="italic">Figure 38: Upload a template</emphasis></para>
      <para arch="">Choose a file from shown dialog</para>
      <para arch=""><screenshot>
          <mediaobject>
            <imageobject>
              <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/choose_upload_file.png" format="PNG"/>
            </imageobject>
          </mediaobject>
        </screenshot></para>
      <para arch=""><emphasis role="italic">Figure 39: Choose a spreadsheet file</emphasis></para>
      <para>Click <emphasis role="bold">Open</emphasis> to choose file, and click <emphasis role="bold">Upload</emphasis> button to upload. If successfully, the uploaded file will be shown in the list:</para>
      <para>
        No upload if the chosen file is not spreadsheet file.</para>
    </section>
    <section id="excelReportingCleanTemporaryDirectory">
      <title>
        <emphasis role="italic">Clean temporary directory</emphasis>
      </title>
      <para>This allows the user to  clean temporary directory.</para>
      <itemizedlist>
        <listitem>
          <para>From <emphasis role="bold">Main</emphasis> menu, choose <emphasis role="bold">Maintenance</emphasis> &gt; <emphasis role="bold">Clean temporary directory </emphasis></para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/clean_temporary_directory.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
          <para><emphasis role="italic">Figure 40: Clean-up temporary files</emphasis></para>
        </listitem>
      </itemizedlist>
    </section>
  </section>
  <section>
    <title>Spreadsheet Reports</title>
    <para>There are 3 functions of the module.</para>
    <orderedlist>
      <listitem>
        <para><emphasis role="italic">Generate Report</emphasis>: Allow users to generate reports according to parameters such as time period, organisation unit, organisation unit group  and to generate group of reports to many sheets of a single  spreadsheet file.</para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Import spreadsheet files</emphasis>: Imports data values from an spreadsheet file to the IROAD2 system.</para>
      </listitem>
      <listitem>
        <para><emphasis role="italic">Data entry Status</emphasis>: View data entry status.</para>
      </listitem>
    </orderedlist>
    <section id="excelReportingReport">
      <title>Generate report</title>
      <para>To generate a report just follow the simple steps outlined below.</para>
      <orderedlist>
        <listitem>
          <para>Click &quot;Generate Report&quot;.</para>
        </listitem>
        <listitem>
          <para>Select an Organisational Unit on the left.</para>
        </listitem>
        <listitem>
          <para>Select a Report Group. </para>
        </listitem>
        <listitem>
          <para>Select a Report from the Report list.</para>
        </listitem>
        <listitem>
          <para>Select a period of time from the Period drop-down.</para>
        </listitem>
        <listitem>
          <para>Click Generate Report button to generate the report.</para>
          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/generate_report.png" format="PNG"/>
              </imageobject>
            </mediaobject>
          </screenshot>
        </listitem>
      </orderedlist>
      <para>With &quot;Preview Report&quot; function, you can preview the report with IROAD2 before download the equivalent spreadsheet report.</para>
      <para>With &quot;Print Preview&quot; (or maybe labelled as &quot;Print Draft&quot;), you can download/print out the current preview report directly without generating a spreadsheet file and this will reduce time-consuming.</para>
    </section>
    <section id="excelReportingDataEntryStatusReport">
      <title>Data entry status report</title>
      <para>This function allows users to see which datasets are entered with data and what percentage of data has been entered for different datasets, organizational units and time periods. This allows the person responsible for monitoring data completeness (e.g. district health manager) to monitor the level of data completness easily.</para>
      <para>View Data entry status</para>
      <para>From Left menu, click Data Entry Status &gt; Select Org Unit name to view.</para>
      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata width="70%" align="center" fileref="resources/images/dhis_excel_reports/data_entry_status_1.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para>The Data entry status is displayed as percentage. The relative percentage of data elements that were entered in the form. </para>
    </section>
  </section>
</chapter>

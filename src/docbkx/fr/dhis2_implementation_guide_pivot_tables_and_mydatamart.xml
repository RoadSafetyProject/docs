<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd"[]>
<chapter>
  <title>Les tableaux croisés dynamiques et l'outil MyDataMart</title>
  <para>Les tableaux croisés dynamiques Excel (voir capture d'écran ci-dessous) sont un outil d'analyse de données puissant et dynamique qui peut être automatiquement connecté aux données IROAD 2. Alors que la plupart des outils de reporting en IROAD 2 sont limités quant à la quantité de données qu'ils peuvent présenter en même temps, les tableaux croisés dynamiques sont conçus pour donner de belles vues d'ensemble de plusieurs éléments de données, indicateurs, unités d'organisation et périodes (voir exemple ci-dessous). De plus, les fonctions dynamiques de pivotement et les listes  déroulantes sont très différentes de ce qui existe sur les feuilles de calcul statiques ou sur de nombreux rapports présents sur le Web, et les SIS en font un outil utile pour les utilisateurs de l'information qui veulent faire une analyse plus profonde et de changer les vues sur les données plus dynamiquement. Ceci, combiné avec les capacités graphiques bien connues d'Excel, a fait pendant longtemps de l'outil de tableaux croisés dynamiques un outil d'analyse populaire parmi les utilisateurs les plus avancés de IROAD.</para>
  <graphic width="100%" format="PNG" fileref="resources/images/implementation_guide/pivot_table.png" align="center" />
  <para>Avec l'évolution récente vers les déploiements en ligne, les tableaux croisés dynamiques Excel hors ligne offrent également une alternative utile aux outils de reporting en ligne, car ils permettent une analyse de données locale ne nécessitant pas de connexion Internet, ce qui peut être un  avantage dans des environnements à connexion instable ou onéreuse. Internet n'est en fait nécessaire que pour le téléchargement de nouvelles données à partir du serveur en ligne, et une fois les données présentes en local, le travail sur les tableaux croisés dynamiques ne nécessite plus de connexion. L'outil MyDatamart, qui est décrit en détail plus bas, permet aux utilisateurs de maintenir un fichier "magasin de données" local (une petite base de données) qui est mis à jour sur Internet à partir du serveur en ligne, et est ensuite utilisé comme une source de données hors ligne pour alimenter les tableaux croisés dynamiques avec des données.</para>
  <section>
    <title>Conception des tableaux croisés dynamiques</title>
    <para>Typiquement, un fichier de tableaux croisés dynamiques Excel créé pour IROAD 2 contient plusieurs feuilles de calcul avec un tableau croisé dynamique sur chaque feuille. Un tableau peut correspondre soit à des valeurs de données brutes (par éléments de données) ou à des valeurs  d'indicateurs, et sera généralement nommé sur la base du niveau de la hiérarchie de l'unité d'organisation d'où proviennent les données agrégées et du type de période (fréquence, par exemple mensuel, annuel) des données. Un fichier de tableaux croisés dynamiques standard de IROAD 2 comprend les tableaux suivants : Indicateurs de district, Données de district mensuelles, Données de District annuelles, Indicateurs des établissements, Données des établissements mensuelles, Données des établissements annuelles. Il pourrait y avoir en plus des tableaux plus spécialisés qui mettent l'accent sur des programmes spécifiques et/ou sur d'autres types de période.</para>
    <para>Une caractéristique populaire de tableaux croisés dynamiques est d'être en mesure de glisser-déposer les différents champs entre les trois positions Page/filtre, ligne, et colonnes, et ainsi changer complètement la vue de données. Ces champs peuvent être considérés comme des dimensions des  valeurs de données et représentent les dimensions dans le modèle de données de IROAD : unité d'organisation (un champ par niveau), éléments de données ou indicateurs, périodes, puis une liste des dimensions supplémentaires représentant les ensembles de groupes et les catégories d'éléments de données (voir les autres chapitres de ce guide pour plus de détails à ce sujet). En fait, un tableau croisé dynamique est un excellent outil pour représenter les nombreuses dimensions créées dans IROAD 2, et il est très facile de faire un zoom en avant ou en arrière sur chaque dimension, comme regarder par exemple les valeurs des données brutes par groupe de tranche d'âge ou tout simplement son total, ou en combinaison avec d'autres dimensions telles que le genre. Toutes les
dimensions créées dans IROAD 2 seront prises en compte dans la liste des champs de chaque tableau croisé dynamique, et c'est à l'utilisateur de choisir lesquels utiliser.</para>
    <para>Il est important de comprendre que les valeurs dans les tableaux croisés dynamiques ne peuvent pas être modifiées et que tous les noms et numéros sont récupérés directement à partir de la base de données IROAD 2, ce qui le rend différent d'un tableur normal. Afin d'être édité, le contenu d'un tableau croisé dynamique doit être copié dans une feuille de calcul normale, mais ceci n'est que rarement nécessaire puisque tous ces noms peuvent être édités dans IROAD 2 (et ensuite être pris en compte dans les tableaux croisés dynamiques lors de la prochaine mise à jour). Les noms (légendes) sur chaque champ peuvent toutefois être modifiées, mais pas leur contenu (valeurs).</para>
  </section>
  <section>
    <title>Connexion à la base de données IROAD 2</title>
    <para>Chaque table possède une connexion à la base de données IROAD 2 et fait usage d'une vue de source de tableau (requête SQL) dans la base de données pour récupérer les données. Ces requêtes récupèrent toutes leurs données à partir des tables des magasins de données, il est donc important de maintenir le magasin de données à jour en tout temps afin d'obtenir les données les plus récentes sur les tableaux croisés dynamiques. Un tableau croisé dynamique peut se connecter à une base de données sur l'ordinateur local ou sur un serveur distant. Il est donc bien adapté pour une  utilisation en réseau local où il y a seulement une base de données partagée et plusieurs ordinateurs clients utilisant les tableaux croisés dynamiques. Excel peut également se connecter à des bases de données fonctionnant sous Linux. La connexion à la base de données utilisée dans les tableaux croisés dynamiques est définie dans une source de données ODBC sur les ordinateurs Windows exécutant des tableaux croisés dynamiques.</para>
    <para>Pour les déploiements en ligne la méthode recommandée pour se connecter aux données IROAD 2 est d'utiliser l'outil MyDatamart, qui crée et met à jour un fichier de magasin de données local (base de données) sur lequel Excel peut se connecter. L'outil MyDatamart sera décrit en détail plus loin.</para>
  </section>
  <section>
    <title>Le traitement de grandes quantités de données</title>
    <para>La quantité de données présente dans une base de données IROAD 2 peut facilement dépasser les capacités d'Excel. Une table possédant environ 1 million de valeurs (lignes de données) a tendance à devenir moins sensible aux mises à jour (actualisations) et aux opérations de pivotement, et sur  certains ordinateurs Excel donnera des erreurs de mémoire lorsqu'il aura à traiter des tableaux de cette taille. En règle générale, plus l'ordinateur est puissant, plus il peut traiter des données, mais la limite supérieure semble être d'environ 1 million de lignes, même sur des ordinateurs haut de gamme.</para>
    <para>Pour faire face à ce problème, la configuration de la table de pivot IROAD standard divise les données et les répartit sur plusieurs tableaux croisés dynamiques. Il y a différentes façons de diviser les données : par niveau d'agrégation de l'unité d'organisation (profondeur), par zone de couverture de l'unité d'organisation (largeur), par période (par exemple une année de données à la fois), ou par élément de données ou groupes d'indicateur (par exemple par programme ou thématique de santé). L'agrégation jusqu'au niveau le plus bas dans la hiérarchie de l'unité d'organisation est l'approche la plus efficace, car elle réduit la quantité de données par un facteur qui est le nombre d'établissements de santé du pays. En général, il n'est pas nécessaire d'examiner en même temps tous les établissements de santé d'un pays, une zone limitée pouvant suffire (par exemple, un district ou une province). Quand il y a un besoin de données pour l'ensemble du pays, celles-ci peuvent être fournies par des agrégats au niveau du district ou d'autres agrégats similaires. Dans un bureau de district ou de province les utilisateurs auront typiquement des données du niveau des établissements de santé que pour leur propre zone; donc pour les régions voisines, les données seront regroupées en un ou deux niveaux pour réduire la taille des données, mais aussi pour permettre la comparaison. Le fractionnement des données par période ou par groupe d'élément de données/indicateurs fonctionne plus ou moins de la même manière, et peut se faire soit en  combinaison avec la scission de l'unité d'organisation ou à sa place. Par exemple si un programme de santé veut analyser quelques éléments de données au niveau des établissements de santé pour l'ensemble du pays. La scission est contrôlée par les vues de pivot dans la base de données où l'on spécifie les valeurs de données à récupérer.</para>
  </section>
  <section>
    <title>L'outil MyDatamart</title>
    <para>Avec des déploiements en ligne et l'utilisation d'un serveur central unique (base de données) et l'utilisation locale des tableaux croisés dynamiques devient plus difficile puisque Excel se connecte directement à la base pour récupérer les données. Cela signifie que Excel (et chaque ordinateur local utilisant IROAD2) aura besoin d'avoir les détails de connexion et de pouvoir  accéder à la base de données sur le serveur, ce qui n'est pas toujours souhaité. En outre, la mise à jour (mise à jour des tableaux croisés dynamiques) dans Excel est une opération qui vide complètement la table avant de recharger toutes les données de nouveau (aussi bien les nouvelles données que les anciennes), ce qui conduit à beaucoup de téléchargements de données sur Internet lors de la connexion à un serveur en ligne. La solution à ces problèmes a été de constituer et de maintenir une "copie" mise à jour de la base de données centrale dans chaque bureau local où les tableaux croisés dynamiques Excel sont utilisés. Ces bases de données locales sont appelées magasin de données (en anglais: data marts) et sont construites spécifiquement pour servir de sources de  données aux outils d'analyse de données comme Excel. L'outil MyDatamart est un nouvel outil qui vient d'être développé (en mai 2011); il crée un fichier de magasin de données sur un ordinateur local et permet aux utilisateurs de le mettre à jour depuis un serveur central. Les tableaux  croisés dynamiques dans Excel se connecteront ainsi uniquement au magasin de données local et n'auront pas nullement besoin d'avoir connaissance du serveur central.</para>
    <para>L'utilisation de MyDatamart réduit considérablement le volume des téléchargements lors des mises à jour de routine des fichiers Excel en local, comparativement à ce que cela nécessiterait si la connexion se faisait directement du fichier Excel vers le serveur central. Il apporte également un  confort aux utilisateurs du niveau local qui pourront avoir une copie de leurs données sur leur ordinateur local et n'auront pas à dépendre de la connexion Internet ou du fonctionnement du serveur pour y accéder. La figure ci-dessous explique comment la liaison entre le serveur central en ligne (dans le cloud) et les bureaux locaux fonctionne.</para>
    <graphic width="100%" format="PNG" fileref="resources/images/implementation_guide/mydatamart.png" align="center" />
  </section>
  <section>
    <title>Utilisation des tableaux croisés dynamiques Excel et MyDatamart - un exemple de flux de travail</title>
    <para>Les détails de l'utilisation de l'outil de MyDatamart sont expliqués dans le manuel de l'utilisateur et cette section se contente d'expliquer le flux de travail existant lors de l'utilisation de l'outil avec les tableaux croisés dynamiques.</para>
    <section>
      <title>Télécharger et exécuter l'outil de MyDatamart pour la première fois</title>
      <para>MyDatamart est un petit outil qui est facile à télécharger et à exécuter immédiatement. Téléchargez le fichier mydatamart.exe sur le bureau et exécutez-le en double-cliquant sur le fichier. La première chose que vous devez faire est de créer un nouveau fichier de magasin de données; saisissez ensuite les informations de connexion nécessaires pour accéder au serveur central (url, nom d'utilisateur, mot de passe). L'outil se connecte au serveur (connexion Internet nécessaire à ce stade) et vérifie alors vos informations. La prochaine étape consiste à télécharger toutes les méta-données du serveur, c'est à dire toutes les unités d'organisation, les éléments de données, les indicateurs, les groupes, etc. Cette opération peut prendre un certain temps selon les caractéristiques de votre ordinateur et la vitesse de votre connexion, mais c'est une étape qui est rarement nécessaire après ce premier téléchargement. Une fois que l'outil connait la hiérarchie de l'unité d'organisation, vous pouvez spécifier l'unité d'organisation à laquelle vous "appartenez" et le niveau d'analyse auquel que vous êtes intéressé. Ce sont des paramètres qui limitent les unités d'organisation pour lesquelles vous téléchargez les données. La prochaine étape est de télécharger les données à partir du serveur, et vous devez alors spécifier les périodes pour lesquelles vous souhaitez effectuer ce téléchargement.</para>
    </section>
    <section>
      <title>Configurer et distribuer les tableaux croisés dynamiques</title>
      <para>La première chose à faire est de télécharger et d'installer un pilote ODBC pour SQLite, qui est le serveur de base de données qui fonctionne dans le magasin de données local. Les connexions de base de données au sein des tableaux croisés dynamiques dépendent de ce pilote et échoueront s'il n'est pas installé.</para>
      <para>La prochaine chose à faire est de mettre en place les tableaux croisés dynamiques eux-mêmes. C'est un travail qui se fait une seule fois car le fichier pourra être réutilisé comme modèle dans tous les autres emplacements qui se connectent à la même base de données centrale. L'outil MyDatamart peut produire un squelette fichier Excel pour vous où toutes les connexions à la base de données nécessaires sont déjà préconfigurées. Cela facilitera considérablement le processus et le travail  restant consistera à sélectionner les champs (devant être utilisés dans chaque tableau) et de leur donner des noms propres. Le manuel d'utilisateur contient toutes les instructions détaillées sur la façon de mettre en place un tableau croisé dynamique en utilisant les connexions MyDatamart. </para>
      <para>Une fois le modèle de fichier Excel disponible, il vous reste à le distribuer à tous les bureaux locaux qui vont utiliser des tableaux croisés dynamiques et vous assurer que les connexions sont toujours valables sur les ordinateurs locaux. Les détails de connexion dans Excel s'appuient sur le pilote ODBC disponible et sur le nom et l'emplacement du fichier de magasin de données. Vous pouvez soitdéfinir les emplacements et les noms des fichiers de magasin de données en local ( par exemple, "C :\dhis2\dhis2.dmart", ou utiliser l'outil MyDatamart pour mettre à jour les informations de connexion dans le fichier Excel existant pour le faire correspondre avec l'emplacement du fichier local de magasin de données.</para>
    </section>
    <section>
      <title>Mettre à jour MyDatamart</title>
      <para>Chaque fois qu'il y a de nouvelles données disponibles sur le serveur central, par exemple, chaque mois, les utilisateurs devront lancer l'outil MyDatamart, se connecter au serveur, et ensuite choisir les mois à télécharger. Une fois le téléchargement terminé les données sont rendues  disponibles localement dans le fichier de magasin de données.</para>
    </section>
    <section>
      <title>Mettre à jour les tableaux croisés dynamiques</title>
      <para>Une fois le fichier de magasin de données local mis à jour, les utilisateurs peuvent mettre à jour les tableaux croisés dynamiques en utilisant la fonction de rafraîchissement des données, sur chaque table. Il est important de se rappeler d'enregistrer le fichier Excel après l'actualisation  de toutes les tables.</para>
    </section>
    <section>
      <title>Répéter les étapes 3 et 4 lorsque de nouvelles données sont disponibles sur le serveur central</title>
      <para>Chaque fois qu'il y a de nouvelles données sur le serveur central, les utilisateurs devront répéter les étapes 3 et 4 (les deux précédentes étapes) afin de mettre à jour leurs tableaux croisés dynamiques et avoir accès aux dernières données.</para>
    </section>
  </section>
</chapter>